{
  "export_date": "2025-10-07T19:39:45.556434",
  "database": "db_piazzati",
  "tables": {
    "alembic_version": {
      "columns": [
        {
          "name": "version_num",
          "type": "character varying",
          "nullable": false,
          "default": null,
          "max_length": 32
        }
      ]
    },
    "documents": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": null,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "type",
          "type": "USER-DEFINED",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "raw_file_url",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "parsed_json",
          "type": "jsonb",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "language",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": 2
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        },
        {
          "name": "title",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "description_raw",
          "type": "text",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "version",
          "type": "integer",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "is_latest",
          "type": "boolean",
          "nullable": false,
          "default": "false",
          "max_length": null
        },
        {
          "name": "status",
          "type": "USER-DEFINED",
          "nullable": true,
          "default": null,
          "max_length": null
        }
      ]
    },
    "embeddings": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": null,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "embedding",
          "type": "USER-DEFINED",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "model_name",
          "type": "text",
          "nullable": true,
          "default": "'sentence-transformers/MiniLM-L12-v2'::text",
          "max_length": null
        },
        {
          "name": "model_dim",
          "type": "integer",
          "nullable": true,
          "default": "384",
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "nullable": true,
          "default": "true",
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        }
      ]
    },
    "search_results": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": null,
          "max_length": null
        },
        {
          "name": "search_id",
          "type": "uuid",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "document_id",
          "type": "uuid",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "score",
          "type": "double precision",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "rank",
          "type": "integer",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "clicked",
          "type": "boolean",
          "nullable": true,
          "default": "false",
          "max_length": null
        },
        {
          "name": "feedback",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        }
      ]
    },
    "searches": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": null,
          "max_length": null
        },
        {
          "name": "user_id",
          "type": "uuid",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "query_text",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "query_vector",
          "type": "USER-DEFINED",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "filters",
          "type": "jsonb",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "type",
          "type": "USER-DEFINED",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        }
      ]
    },
    "users": {
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": null,
          "max_length": null
        },
        {
          "name": "name",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "email",
          "type": "character varying",
          "nullable": false,
          "default": null,
          "max_length": null
        },
        {
          "name": "password_hash",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "role",
          "type": "USER-DEFINED",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": "now()",
          "max_length": null
        },
        {
          "name": "last_login",
          "type": "timestamp without time zone",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "is_active",
          "type": "boolean",
          "nullable": true,
          "default": "true",
          "max_length": null
        },
        {
          "name": "phone",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        },
        {
          "name": "company",
          "type": "character varying",
          "nullable": true,
          "default": null,
          "max_length": null
        }
      ]
    }
  },
  "extensions": [
    {
      "name": "vector",
      "version": "0.8.1"
    }
  ],
  "enums": {
    "document_status": [
      "uploaded",
      "parsed",
      "parsing_failed",
      "embedding_failed",
      "draft",
      "open",
      "closed"
    ],
    "document_type": [
      "cv",
      "jd"
    ],
    "search_type": [
      "cv_search",
      "jd_search"
    ],
    "user_role": [
      "candidate",
      "recruiter",
      "admin"
    ]
  },
  "constraints": [
    {
      "table": "alembic_version",
      "name": "2200_16754_1_not_null",
      "type": "CHECK",
      "definition": "version_num IS NOT NULL"
    },
    {
      "table": "alembic_version",
      "name": "alembic_version_pkc",
      "type": "PRIMARY KEY",
      "definition": null
    },
    {
      "table": "documents",
      "name": "2200_16757_12_not_null",
      "type": "CHECK",
      "definition": "is_latest IS NOT NULL"
    },
    {
      "table": "documents",
      "name": "check_language_format",
      "type": "CHECK",
      "definition": "(((language)::text ~ '^[a-z]{2}$'::text))"
    },
    {
      "table": "documents",
      "name": "2200_16757_1_not_null",
      "type": "CHECK",
      "definition": "id IS NOT NULL"
    },
    {
      "table": "documents",
      "name": "documents_user_id_fkey",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "documents",
      "name": "documents_pkey",
      "type": "PRIMARY KEY",
      "definition": null
    },
    {
      "table": "embeddings",
      "name": "2200_16770_1_not_null",
      "type": "CHECK",
      "definition": "id IS NOT NULL"
    },
    {
      "table": "embeddings",
      "name": "check_vector_normalized",
      "type": "CHECK",
      "definition": "((abs(((1.0)::double precision - (embedding <#> embedding))) < (0.01)::double precision))"
    },
    {
      "table": "embeddings",
      "name": "embeddings_document_id_fkey",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "embeddings",
      "name": "fk_embeddings_document",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "embeddings",
      "name": "embeddings_pkey",
      "type": "PRIMARY KEY",
      "definition": null
    },
    {
      "table": "embeddings",
      "name": "embeddings_document_id_key",
      "type": "UNIQUE",
      "definition": null
    },
    {
      "table": "search_results",
      "name": "2200_16785_1_not_null",
      "type": "CHECK",
      "definition": "id IS NOT NULL"
    },
    {
      "table": "search_results",
      "name": "fk_search_results_document",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "search_results",
      "name": "fk_search_results_search",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "search_results",
      "name": "search_results_document_id_fkey",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "search_results",
      "name": "search_results_search_id_fkey",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "search_results",
      "name": "search_results_pkey",
      "type": "PRIMARY KEY",
      "definition": null
    },
    {
      "table": "searches",
      "name": "2200_16792_1_not_null",
      "type": "CHECK",
      "definition": "id IS NOT NULL"
    },
    {
      "table": "searches",
      "name": "searches_user_id_fkey",
      "type": "FOREIGN KEY",
      "definition": null
    },
    {
      "table": "searches",
      "name": "searches_pkey",
      "type": "PRIMARY KEY",
      "definition": null
    },
    {
      "table": "users",
      "name": "2200_16798_1_not_null",
      "type": "CHECK",
      "definition": "id IS NOT NULL"
    },
    {
      "table": "users",
      "name": "2200_16798_3_not_null",
      "type": "CHECK",
      "definition": "email IS NOT NULL"
    },
    {
      "table": "users",
      "name": "users_pkey",
      "type": "PRIMARY KEY",
      "definition": null
    },
    {
      "table": "users",
      "name": "users_email_key",
      "type": "UNIQUE",
      "definition": null
    }
  ],
  "indexes": [
    {
      "table": "alembic_version",
      "name": "alembic_version_pkc",
      "definition": "CREATE UNIQUE INDEX alembic_version_pkc ON public.alembic_version USING btree (version_num)"
    },
    {
      "table": "documents",
      "name": "documents_pkey",
      "definition": "CREATE UNIQUE INDEX documents_pkey ON public.documents USING btree (id)"
    },
    {
      "table": "documents",
      "name": "gin_parsed_json_idx",
      "definition": "CREATE INDEX gin_parsed_json_idx ON public.documents USING gin (parsed_json)"
    },
    {
      "table": "documents",
      "name": "idx_jd_open_lang",
      "definition": "CREATE INDEX idx_jd_open_lang ON public.documents USING btree (language, created_at) WHERE ((type = 'jd'::document_type) AND (status = 'open'::document_status))"
    },
    {
      "table": "documents",
      "name": "unique_latest_cv_per_user",
      "definition": "CREATE UNIQUE INDEX unique_latest_cv_per_user ON public.documents USING btree (user_id) WHERE ((type = 'cv'::document_type) AND (is_latest = true))"
    },
    {
      "table": "embeddings",
      "name": "embedding_ann_idx",
      "definition": "CREATE INDEX embedding_ann_idx ON public.embeddings USING ivfflat (embedding vector_cosine_ops) WITH (lists='100')"
    },
    {
      "table": "embeddings",
      "name": "embeddings_document_id_key",
      "definition": "CREATE UNIQUE INDEX embeddings_document_id_key ON public.embeddings USING btree (document_id)"
    },
    {
      "table": "embeddings",
      "name": "embeddings_pkey",
      "definition": "CREATE UNIQUE INDEX embeddings_pkey ON public.embeddings USING btree (id)"
    },
    {
      "table": "search_results",
      "name": "search_rank_idx",
      "definition": "CREATE INDEX search_rank_idx ON public.search_results USING btree (search_id, rank)"
    },
    {
      "table": "search_results",
      "name": "search_results_pkey",
      "definition": "CREATE UNIQUE INDEX search_results_pkey ON public.search_results USING btree (id)"
    },
    {
      "table": "searches",
      "name": "idx_searches_query_vector",
      "definition": "CREATE INDEX idx_searches_query_vector ON public.searches USING ivfflat (query_vector vector_cosine_ops) WITH (lists='100')"
    },
    {
      "table": "searches",
      "name": "searches_pkey",
      "definition": "CREATE UNIQUE INDEX searches_pkey ON public.searches USING btree (id)"
    },
    {
      "table": "searches",
      "name": "user_search_history_idx",
      "definition": "CREATE INDEX user_search_history_idx ON public.searches USING btree (user_id, created_at)"
    },
    {
      "table": "users",
      "name": "users_email_key",
      "definition": "CREATE UNIQUE INDEX users_email_key ON public.users USING btree (email)"
    },
    {
      "table": "users",
      "name": "users_pkey",
      "definition": "CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id)"
    }
  ],
  "postgresql_version": "PostgreSQL 15.14 (Debian 15.14-1.pgdg12+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 12.2.0-14+deb12u1) 12.2.0, 64-bit"
}